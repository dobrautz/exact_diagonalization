function [ determinant ] = calcDeterminant(x)
%CALCDETERMINANT explicit parallel calculation of small determinants

[sizeMat,~,~] = size(x);

if sizeMat == 6
    
    A12 = x(1,5,:).*x(2,6,:) - x(2,5,:).*x(1,6,:);
    A13 = x(1,5,:).*x(3,6,:) - x(3,5,:).*x(1,6,:);
    A14 = x(1,5,:).*x(4,6,:) - x(4,5,:).*x(1,6,:);
    A15 = x(1,5,:).*x(5,6,:) - x(5,5,:).*x(1,6,:);
    A16 = x(1,5,:).*x(6,6,:) - x(6,5,:).*x(1,6,:);
    
    A23 = x(2,5,:).*x(3,6,:) - x(3,5,:).*x(2,6,:);
    A24 = x(2,5,:).*x(4,6,:) - x(4,5,:).*x(2,6,:);
    A25 = x(2,5,:).*x(5,6,:) - x(5,5,:).*x(2,6,:);
    A26 = x(2,5,:).*x(6,6,:) - x(6,5,:).*x(2,6,:);

    
    A34 = x(3,5,:).*x(4,6,:) - x(4,5,:).*x(3,6,:);
    A35 = x(3,5,:).*x(5,6,:) - x(5,5,:).*x(3,6,:);
    A36 = x(3,5,:).*x(6,6,:) - x(6,5,:).*x(3,6,:);
    
    A45 = x(4,5,:).*x(5,6,:) - x(5,5,:).*x(4,6,:);
    A46 = x(4,5,:).*x(6,6,:) - x(6,5,:).*x(4,6,:);
    
    A56 = x(5,5,:).*x(6,6,:) - x(6,5,:).*x(5,6,:);
      
    B123 = x(1,4,:).*A23 - x(2,4,:).*A13 + x(3,4,:).*A12;
    B124 = x(1,4,:).*A24 - x(2,4,:).*A14 + x(4,4,:).*A12;
    B125 = x(1,4,:).*A25 - x(2,4,:).*A15 + x(5,4,:).*A12;
    B126 = x(1,4,:).*A26 - x(2,4,:).*A16 + x(6,4,:).*A12;

    B134 = x(1,4,:).*A34 - x(3,4,:).*A14 + x(4,4,:).*A13;
    B135 = x(1,4,:).*A35 - x(3,4,:).*A15 + x(5,4,:).*A13;
    B136 = x(1,4,:).*A36 - x(3,4,:).*A16 + x(6,4,:).*A13;
    
    B145 = x(1,4,:).*A45 - x(4,4,:).*A15 + x(5,4,:).*A14;
    B146 = x(1,4,:).*A46 - x(4,4,:).*A16 + x(6,4,:).*A14;
    
    B156 = x(1,4,:).*A56 - x(5,4,:).*A16 + x(6,4,:).*A15;
    
    B234 = x(2,4,:).*A34 - x(3,4,:).*A24 + x(4,4,:).*A23;
    B235 = x(2,4,:).*A35 - x(3,4,:).*A25 + x(5,4,:).*A23;
    B236 = x(2,4,:).*A36 - x(3,4,:).*A26 + x(6,4,:).*A23;
    
    B245 = x(2,4,:).*A45 - x(4,4,:).*A25 + x(5,4,:).*A24;
    B246 = x(2,4,:).*A46 - x(4,4,:).*A26 + x(6,4,:).*A24;
    
    B256 = x(2,4,:).*A56 - x(5,4,:).*A26 + x(6,4,:).*A25;
    
    B345 = x(3,4,:).*A45 - x(4,4,:).*A35 + x(5,4,:).*A34;
    B346 = x(3,4,:).*A46 - x(4,4,:).*A36 + x(6,4,:).*A34;
    
    B356 = x(3,4,:).*A56 - x(5,4,:).*A36 + x(6,4,:).*A35;
    
    B456 = x(4,4,:).*A56 - x(5,4,:).*A46 + x(6,4,:).*A45;
    
    C1234 = x(1,3,:).*B234 - x(2,3,:).*B134 + x(3,3,:).*B124 - x(4,3,:).*B123;
    C1235 = x(1,3,:).*B235 - x(2,3,:).*B135 + x(3,3,:).*B125 - x(5,3,:).*B123;
    C1236 = x(1,3,:).*B236 - x(2,3,:).*B136 + x(3,3,:).*B126 - x(6,3,:).*B123;
    
    C1245 = x(1,3,:).*B245 - x(2,3,:).*B145 + x(4,3,:).*B125 - x(5,3,:).*B124;
    C1246 = x(1,3,:).*B246 - x(2,3,:).*B146 + x(4,3,:).*B126 - x(6,3,:).*B124;
    
    C1256 = x(1,3,:).*B256 - x(2,3,:).*B156 + x(5,3,:).*B126 - x(6,3,:).*B125;

    C1345 = x(1,3,:).*B345 - x(3,3,:).*B145 + x(4,3,:).*B135 - x(5,3,:).*B134;
    C1346 = x(1,3,:).*B346 - x(3,3,:).*B146 + x(4,3,:).*B136 - x(6,3,:).*B134;
    
    C1356 = x(1,3,:).*B356 - x(3,3,:).*B156 + x(5,3,:).*B136 - x(6,3,:).*B135;
    
    C1456 = x(1,3,:).*B456 - x(4,3,:).*B156 + x(5,3,:).*B146 - x(6,3,:).*B145;
    
    C2345 = x(2,3,:).*B345 - x(3,3,:).*B245 + x(4,3,:).*B235 - x(5,3,:).*B234;
    C2346 = x(2,3,:).*B346 - x(3,3,:).*B246 + x(4,3,:).*B236 - x(6,3,:).*B234;
    
    C2356 = x(2,3,:).*B356 - x(3,3,:).*B256 + x(5,3,:).*B236 - x(6,3,:).*B235;
    
    C2456 = x(2,3,:).*B456 - x(4,3,:).*B256 + x(5,3,:).*B246 - x(6,3,:).*B245;
    
    C3456 = x(3,3,:).*B456 - x(4,3,:).*B356 + x(5,3,:).*B346 - x(6,3,:).*B345;
    
    keyboard
    
determinant = x(1,1,:).*(x(2,2,:).*C3456 - x(3,2,:).*C2456 + x(4,2,:).*C2356 - x(5,2,:).*C2346 + x(6,2,:).*C2345)...
             -x(2,1,:).*(x(1,2,:).*C3456 - x(3,2,:).*C1456 + x(4,2,:).*C1356 - x(5,2,:).*C1346 + x(6,2,:).*C1345)...
             +x(3,1,:).*(x(1,2,:).*C2456 - x(2,2,:).*C1456 + x(4,2,:).*C1256 - x(5,2,:).*C1246 + x(6,2,:).*C1245)...
             -x(4,1,:).*(x(1,2,:).*C2356 - x(2,2,:).*C1356 + x(3,2,:).*C1256 - x(5,2,:).*C1236 + x(6,2,:).*C1235)...
             +x(5,1,:).*(x(1,2,:).*C2346 - x(2,2,:).*C1346 + x(3,2,:).*C1246 - x(4,2,:).*C1236 + x(6,2,:).*C1234)...  
             -x(6,1,:).*(x(1,2,:).*C2345 - x(2,2,:).*C1345 + x(3,2,:).*C1245 - x(4,2,:).*C1235 + x(5,2,:).*C1234);
         
         
elseif sizeMat == 5
    
    A12 = x(1,4,:).*x(2,5,:) - x(2,4,:).*x(1,5,:);
    A13 = x(1,4,:).*x(3,5,:) - x(3,4,:).*x(1,5,:);
    A14 = x(1,4,:).*x(4,5,:) - x(4,4,:).*x(1,5,:);
    A15 = x(1,4,:).*x(5,5,:) - x(5,4,:).*x(1,5,:);
    
    A23 = x(2,4,:).*x(3,5,:) - x(3,4,:).*x(2,5,:);
    A24 = x(2,4,:).*x(4,5,:) - x(4,4,:).*x(2,5,:);
    A25 = x(2,4,:).*x(5,5,:) - x(5,4,:).*x(2,5,:);
    
    A34 = x(3,4,:).*x(4,5,:) - x(4,4,:).*x(3,5,:);
    A35 = x(3,4,:).*x(5,5,:) - x(5,4,:).*x(3,5,:);
    
    A45 = x(4,4,:).*x(5,5,:) - x(5,4,:).*x(4,5,:);
    
    B345 = x(3,3,:).*A45 - x(4,3,:).*A35 + x(5,3,:).*A34;
    B245 = x(2,3,:).*A45 - x(4,3,:).*A25 + x(5,3,:).*A24;
    B235 = x(2,3,:).*A35 - x(3,3,:).*A25 + x(5,3,:).*A23;
    B234 = x(2,3,:).*A34 - x(3,3,:).*A24 + x(4,3,:).*A23;
    
    B145 = x(1,3,:).*A45 - x(4,3,:).*A15 + x(5,3,:).*A14;
    B135 = x(1,3,:).*A35 - x(3,3,:).*A15 + x(5,3,:).*A13;
    B134 = x(1,3,:).*A34 - x(3,3,:).*A14 + x(4,3,:).*A13;
    
    B125 = x(1,3,:).*A25 - x(2,3,:).*A15 + x(5,3,:).*A12;
    B124 = x(1,3,:).*A24 - x(2,3,:).*A14 + x(4,3,:).*A12;
    
    B123 = x(1,3,:).*A23 - x(2,3,:).*A13 + x(3,3,:).*A12;
    
determinant = x(1,1,:).*(x(2,2,:).*B345 -x(3,2,:).*B245 +x(4,2,:).*B235 -x(5,2,:).*B234) ...
             -x(2,1,:).*(x(1,2,:).*B345 -x(3,2,:).*B145 +x(4,2,:).*B135 -x(5,2,:).*B134) ...
             +x(3,1,:).*(x(1,2,:).*B245 -x(2,2,:).*B145 +x(4,2,:).*B125 -x(5,2,:).*B124) ...
             -x(4,1,:).*(x(1,2,:).*B235 -x(2,2,:).*B135 +x(3,2,:).*B125 -x(5,2,:).*B123)...
             +x(5,1,:).*(x(1,2,:).*B234 -x(2,2,:).*B134 +x(3,2,:).*B124 -x(4,2,:).*B123);  
    

elseif sizeMat == 4
    
    A12 = x(1,3,:).*x(2,4,:)-x(2,3,:).*x(1,4,:);
    A13 = x(1,3,:).*x(3,4,:)-x(3,3,:).*x(1,4,:);
    A14 = x(1,3,:).*x(4,4,:)-x(4,3,:).*x(1,4,:);

    A23 = x(2,3,:).*x(3,4,:)-x(3,3,:).*x(2,4,:);
    A24 = x(2,3,:).*x(4,4,:)-x(4,3,:).*x(2,4,:);

    A34 = x(3,3,:).*x(4,4,:)-x(4,3,:).*x(3,4,:);

    
    
    determinant = x(1,1,:).*(x(2,2,:).*A34 -x(3,2,:).*A24 +x(4,2,:).*A23)... 
                 -x(2,1,:).*(x(1,2,:).*A34 -x(3,2,:).*A14 +x(4,2,:).*A13)... 
                 +x(3,1,:).*(x(1,2,:).*A24 -x(2,2,:).*A14 +x(4,2,:).*A12)... 
                 -x(4,1,:).*(x(1,2,:).*A23 -x(2,2,:).*A13 +x(3,2,:).*A12);
             
elseif sizeMat == 3
    
    A12 = x(1,2,:).*x(2,3,:)-x(2,2,:).*x(1,3,:);
    A13 = x(1,2,:).*x(3,3,:)-x(3,2,:).*x(1,3,:);

    A23 = x(2,2,:).*x(3,3,:)-x(3,2,:).*x(2,3,:);

    
    determinant = x(1,1,:).*A23 - x(2,1,:).*A13 + x(3,1,:).*A12;
    
elseif sizeMat == 2
    
    determinant = x(1,1,:).*x(2,2,:) - x(2,1,:).*x(1,2,:);
    
elseif sizeMat == 1
    
    determinant = x(1,1,:);
    
end


determinant = determinant(:);

%%
% x(1,1,:).*[ x(2,2,:).*[x(3,3,:).*[x(4,4,:).*x(5,5,:)-x(5,4,:).*x(4,5,:)]
%                       -x(4,3,:).*[x(3,4,:).*x(5,5,:)-x(5,4,:).*x(3,5,:)]
%                       +x(5,3,:).*[x(3,4,:).*x(4,5,:)-x(4,4,:).*x(3,5,:)]] 
%                        
%            -x(3,2,:).*[x(2,3,:).*[x(4,4,:).*x(5,5,:)-x(5,4,:).*x(4,5,:)]
%                       -x(4,3,:).*[x(2,4,:).*x(5,5,:)-x(5,4,:).*x(2,5,:)]
%                       +x(5,3,:).*[x(2,4,:).*x(4,5,:)-x(4,4,:).*x(2,5,:)]] 
%            
%            +x(4,2,:).*[x(2,3,:).*[x(3,4,:).*x(5,5,:)-x(5,4,:).*x(3,5,:)]
%                       -x(3,3,:).*[x(2,4,:).*x(5,5,:)-x(5,4,:).*x(2,5,:)]
%                       +x(5,3,:).*[x(2,4,:).*x(3,5,:)-x(3,4,:).*x(2,5,:)]] 
%            
%            -x(5,2,:).*[x(2,3,:).*[x(3,4,:).*x(4,5,:)-x(4,4,:).*x(3,5,:)]
%                       -x(3,3,:).*[x(2,4,:).*x(4,5,:)-x(4,4,:).*x(2,5,:)]
%                       +x(4,3,:).*[x(2,4,:).*x(3,5,:)-x(3,4,:).*x(2,5,:)]]] ...
%        
% -x(2,1,:).*[x(1,2,:).*[x(3,3,:).*[x(4,4,:).*x(5,5,:)-x(5,4,:).*x(4,5,:)]
%                       -x(4,3,:).*[x(3,4,:).*x(5,5,:)-x(5,4,:).*x(3,5,:)]
%                       +x(5,3,:).*[x(3,4,:).*x(4,5,:)-x(4,4,:).*x(3,5,:)]] 
%                        
%            -x(3,2,:).*[x(1,3,:).*[x(4,4,:).*x(5,5,:)-x(5,4,:).*x(4,5,:)]
%                       -x(4,3,:).*[x(1,4,:).*x(5,5,:)-x(5,4,:).*x(1,5,:)]
%                       +x(5,3,:).*[x(1,4,:).*x(4,5,:)-x(4,4,:).*x(1,5,:)]] 
%            
%            +x(4,2,:).*[x(1,3,:).*[x(3,4,:).*x(5,5,:)-x(5,4,:).*x(3,5,:)]
%                       -x(3,3,:).*[x(1,4,:).*x(5,5,:)-x(5,4,:).*x(1,5,:)]
%                       +x(5,3,:).*[x(1,4,:).*x(3,5,:)-x(3,4,:).*x(1,5,:)]] 
%            
%            -x(5,2,:).*[x(1,3,:).*[x(3,4,:).*x(4,5,:)-x(4,4,:).*x(3,5,:)]
%                       -x(3,3,:).*[x(1,4,:).*x(4,5,:)-x(4,4,:).*x(1,5,:)]
%                       +x(4,3,:).*[x(1,4,:).*x(3,5,:)-x(3,4,:).*x(1,5,:)]]] 
%     
% 
%        
% + x(3,1,:).*[x(1,2,:).*[x(2,3,:).*[x(4,4,:).*x(5,5,:)-x(5,4,:).*x(4,5,:)]
%                       -x(4,3,:).*[x(2,4,:).*x(5,5,:)-x(5,4,:).*x(2,5,:)]
%                       +x(5,3,:).*[x(2,4,:).*x(4,5,:)-x(4,4,:).*x(2,5,:)]] 
%                        
%            -x(2,2,:).*[x(1,3,:).*[x(4,4,:).*x(5,5,:)-x(5,4,:).*x(4,5,:)]
%                       -x(4,3,:).*[x(1,4,:).*x(5,5,:)-x(5,4,:).*x(1,5,:)]
%                       +x(5,3,:).*[x(1,4,:).*x(4,5,:)-x(4,4,:).*x(1,5,:)]] 
%            
%            +x(4,2,:).*[x(1,3,:).*[x(2,4,:).*x(5,5,:)-x(5,4,:).*x(2,5,:)]
%                       -x(2,3,:).*[x(1,4,:).*x(5,5,:)-x(5,4,:).*x(1,5,:)]
%                       +x(5,3,:).*[x(1,4,:).*x(2,5,:)-x(2,4,:).*x(1,5,:)]] 
%            
%            -x(5,2,:).*[x(1,3,:).*[x(2,4,:).*x(4,5,:)-x(4,4,:).*x(2,5,:)]
%                       -x(2,3,:).*[x(1,4,:).*x(4,5,:)-x(4,4,:).*x(1,5,:)]
%                       +x(4,3,:).*[x(1,4,:).*x(2,5,:)-x(2,4,:).*x(1,5,:)]]]
%        
% -x(4,1,:).*[x(1,2,:).*[x(2,3,:).*[x(3,4,:).*x(5,5,:)-x(5,4,:).*x(3,5,:)]
%                       -x(3,3,:).*[x(2,4,:).*x(5,5,:)-x(5,4,:).*x(2,5,:)]
%                       +x(5,3,:).*[x(2,4,:).*x(3,5,:)-x(3,4,:).*x(2,5,:)]] 
%                        
%            -x(2,2,:).*[x(1,3,:).*[x(3,4,:).*x(5,5,:)-x(5,4,:).*x(3,5,:)]
%                       -x(3,3,:).*[x(1,4,:).*x(5,5,:)-x(5,4,:).*x(1,5,:)]
%                       +x(5,3,:).*[x(1,4,:).*x(3,5,:)-x(3,4,:).*x(1,5,:)]] 
%            
%            +x(3,2,:).*[x(1,3,:).*[x(2,4,:).*x(5,5,:)-x(5,4,:).*x(2,5,:)]
%                       -x(2,3,:).*[x(1,4,:).*x(5,5,:)-x(5,4,:).*x(1,5,:)]
%                       +x(5,3,:).*[x(1,4,:).*x(2,5,:)-x(2,4,:).*x(1,5,:)]] 
%            
%            -x(5,2,:).*[x(1,3,:).*[x(2,4,:).*x(3,5,:)-x(3,4,:).*x(2,5,:)]
%                       -x(2,3,:).*[x(1,4,:).*x(3,5,:)-x(3,4,:).*x(1,5,:)]
%                       +x(3,3,:).*[x(1,4,:).*x(2,5,:)-x(2,4,:).*x(1,5,:)]]]
%        
% +x(5,1,:).*[x(1,2,:).*[x(2,3,:).*[x(3,4,:).*x(4,5,:)-x(4,4,:).*x(3,5,:)]
%                       -x(3,3,:).*[x(2,4,:).*x(4,5,:)-x(4,4,:).*x(2,5,:)]
%                       +x(4,3,:).*[x(2,4,:).*x(3,5,:)-x(3,4,:).*x(2,5,:)]] 
%                        
%            -x(2,2,:).*[x(1,3,:).*[x(3,4,:).*x(4,5,:)-x(4,4,:).*x(3,5,:)]
%                       -x(3,3,:).*[x(1,4,:).*x(4,5,:)-x(4,4,:).*x(1,5,:)]
%                       +x(4,3,:).*[x(1,4,:).*x(3,5,:)-x(3,4,:).*x(1,5,:)]] 
%            
%            +x(3,2,:).*[x(1,3,:).*[x(2,4,:).*x(4,5,:)-x(4,4,:).*x(2,5,:)]
%                       -x(2,3,:).*[x(1,4,:).*x(4,5,:)-x(4,4,:).*x(1,5,:)]
%                       +x(4,3,:).*[x(1,4,:).*x(2,5,:)-x(2,4,:).*x(1,5,:)]] 
%            
%            -x(4,2,:).*[x(1,3,:).*[x(2,4,:).*x(3,5,:)-x(3,4,:).*x(2,5,:)]
%                       -x(2,3,:).*[x(1,4,:).*x(3,5,:)-x(3,4,:).*x(1,5,:)]
%                       +x(3,3,:).*[x(1,4,:).*x(2,5,:)-x(2,4,:).*x(1,5,:)]]]